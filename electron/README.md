# Electron 模块架构设计

本项目的 Electron 部分采用模块化架构设计，遵循单一职责原则，将功能划分为独立的模块。

## 模块化原则

- 统一使用 ESM 模块规范，不使用 CommonJS
- 所有模块文件使用 `.mjs` 扩展名
- 每个模块专注于单一功能
- 通过明确的接口进行模块间通信

## 目录结构

```
electron/
├── main.mjs           # 应用入口
├── preload.mjs        # 预加载脚本
├── constants.mjs      # 常量定义
├── config.mjs         # 配置管理
├── window.mjs         # 窗口管理
├── ipc.mjs            # IPC 通信
├── projectScanner.mjs # 项目扫描
├── openProject.mjs    # 项目打开
├── appInfo.mjs        # 应用信息
├── rules.mjs          # 架构规范
└── README.md          # 本文档
```

## 核心模块职责

### main.mjs
应用的入口文件，负责初始化应用、创建窗口和设置 IPC 处理程序。

### preload.mjs
预加载脚本，在渲染进程中安全地暴露 Node.js API，实现渲染进程和主进程之间的通信桥梁。

### constants.mjs
定义应用中使用的常量，如窗口尺寸、项目类型等。

### config.mjs
负责应用配置和项目配置的读写操作，提供统一的配置访问接口。

### window.mjs
负责创建和管理应用窗口，处理窗口的生命周期和事件。

### ipc.mjs
负责处理渲染进程和主进程间的通信，设置 IPC 处理程序。

### projectScanner.mjs
负责扫描目录和检测项目类型，提供项目发现功能。

### openProject.mjs
负责使用不同编辑器打开项目，支持多种编辑器和打开方式。

### appInfo.mjs
负责收集和提供应用信息，如版本、路径等。

## 通信规范

### IPC 命名规范

- `get-*`: 获取数据的方法
- `set-*`: 设置数据的方法
- `*-action`: 执行动作的方法
- `*-event`: 事件通知

### 错误处理

所有模块使用统一的错误回调机制，通过 `main-process-error` 事件将错误信息传递给渲染进程。

## 安全规范

- 启用上下文隔离
- 禁用 Node 集成
- 禁用远程模块
- 使用内容安全策略

## 模块扩展

如需添加新功能，请遵循以下步骤：

1. 创建新的模块文件，使用 `.mjs` 扩展名
2. 在模块中定义清晰的公共接口
3. 在 `main.mjs` 或相关模块中导入并使用新模块
4. 更新本文档，说明新模块的职责

## 最佳实践

- 使用 `path.join()` 而非字符串拼接处理路径
- 使用异步操作处理文件读写
- 实现错误处理和重试机制
- 考虑跨平台路径差异 (Windows/macOS/Linux) 